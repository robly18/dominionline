<html>
<head>

<script>
function ajax(url, data, callback) {
  var xhttp;
  xhttp=new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      callback(this);
    }
  };
  xhttp.open("POST", url, true);
  xhttp.send(data);
}

function writeToLog(data) {
	let stuff = JSON.parse(data.responseText);
	let lines = stuff.story;
	let log = document.getElementById("log");
	log.innerHTML = "";
	for (let line of lines) {
		let node = document.createTextNode(line);
		log.appendChild(node);
		log.appendChild(document.createElement("br"));
	}
}
</script>
</head>
<body>
<h1>Hello world.</h1>

<p id="log">No messages yet.</p>

<input type="text" id="box">Type something!</input>

<br>

<button type="button"
onclick="ajax('/send/', document.getElementById('box').value, writeToLog)">Bluh
</button>

<script>window.setInterval(function(){ajax('/send/', "", writeToLog)}, 1000)</script>
</body>
</html>